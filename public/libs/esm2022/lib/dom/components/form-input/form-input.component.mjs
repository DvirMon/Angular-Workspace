import { CommonModule } from "@angular/common";
import { ChangeDetectionStrategy, Component, Injector, computed, inject, input, runInInjectionContext, } from "@angular/core";
import { toSignal } from "@angular/core/rxjs-interop";
import { ReactiveFormsModule, } from "@angular/forms";
import { MatFormFieldModule } from "@angular/material/form-field";
import { MatInputModule } from "@angular/material/input";
import { map, startWith } from "rxjs";
import { errorMessageMap } from "./form.helper";
import * as i0 from "@angular/core";
import * as i1 from "@angular/forms";
import * as i2 from "@angular/material/form-field";
import * as i3 from "@angular/material/input";
export class FormInputComponent {
    constructor() {
        this._injector = inject(Injector);
        this.control = input.required();
        this.key = input.required();
        this.type = input();
        this.label = input();
        this.hint = input();
        this.errorsMap = input();
    }
    ngOnInit() {
        this.formControl = computed(() => this.control());
        this.hasError = this._setHasErrorSignal(this.formControl());
        this.errorMessage = this._setErrorMessageSignal(this.formControl());
    }
    _setErrorMessageSignal(formControl) {
        return runInInjectionContext(this._injector, () => toSignal(this._setErrorObservable(formControl), {
            initialValue: this._getErrorMessage(formControl),
        }));
    }
    _setErrorObservable(formControl) {
        return formControl.statusChanges.pipe(map(() => this._getErrorMessage(formControl)));
    }
    _setHasErrorSignal(formControl) {
        return runInInjectionContext(this._injector, () => toSignal(this._setHasErrorObservable(formControl), {
            initialValue: false,
        }));
    }
    _setHasErrorObservable(formControl) {
        return formControl.statusChanges.pipe(startWith(formControl.status), map(() => formControl.errors), map((errors) => !!errors));
    }
    // handle input error messages
    _getErrorMessage(control) {
        const errors = { ...control.errors };
        if (errors) {
            const errorKeys = Object.keys(errors);
            for (const error of errorKeys) {
                if (control.hasError(error)) {
                    const errorMap = {
                        ...errors,
                        ...errorMessageMap,
                        ...this.errorsMap(),
                    };
                    return errorMap[error];
                }
            }
        }
        return "";
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.2.2", ngImport: i0, type: FormInputComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "17.2.2", type: FormInputComponent, isStandalone: true, selector: "dom-form-input", inputs: { control: { classPropertyName: "control", publicName: "control", isSignal: true, isRequired: true, transformFunction: null }, key: { classPropertyName: "key", publicName: "key", isSignal: true, isRequired: true, transformFunction: null }, type: { classPropertyName: "type", publicName: "type", isSignal: true, isRequired: false, transformFunction: null }, label: { classPropertyName: "label", publicName: "label", isSignal: true, isRequired: false, transformFunction: null }, hint: { classPropertyName: "hint", publicName: "hint", isSignal: true, isRequired: false, transformFunction: null }, errorsMap: { classPropertyName: "errorsMap", publicName: "errorsMap", isSignal: true, isRequired: false, transformFunction: null } }, ngImport: i0, template: "<mat-form-field class=\"full-width\">\n  <mat-label>{{ label() }}</mat-label>\n  <input\n    #input\n    matInput\n    [type]=\"type() || 'text'\"\n    [formControl]=\"formControl()\"\n    autocomplete=\"off\"\n    [name]=\"key()\"\n  />\n\n  @if (hint()) {\n\n  <!-- <mat-hint> {{ \"Please enter your \" + hint() }}</mat-hint> -->\n  <mat-hint> {{ formControl().errors }}</mat-hint>\n  } @if (hasError()) {\n  <mat-error>{{ errorMessage() }}</mat-error>\n  }\n</mat-form-field>\n", styles: ["mat-form-field{width:100%;display:inline-block}input[type=number]::-webkit-inner-spin-button{-webkit-appearance:none}\n"], dependencies: [{ kind: "ngmodule", type: CommonModule }, { kind: "ngmodule", type: ReactiveFormsModule }, { kind: "directive", type: i1.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i1.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i1.FormControlDirective, selector: "[formControl]", inputs: ["formControl", "disabled", "ngModel"], outputs: ["ngModelChange"], exportAs: ["ngForm"] }, { kind: "ngmodule", type: MatFormFieldModule }, { kind: "component", type: i2.MatFormField, selector: "mat-form-field", inputs: ["hideRequiredMarker", "color", "floatLabel", "appearance", "subscriptSizing", "hintLabel"], exportAs: ["matFormField"] }, { kind: "directive", type: i2.MatLabel, selector: "mat-label" }, { kind: "directive", type: i2.MatHint, selector: "mat-hint", inputs: ["align", "id"] }, { kind: "directive", type: i2.MatError, selector: "mat-error, [matError]", inputs: ["id"] }, { kind: "ngmodule", type: MatInputModule }, { kind: "directive", type: i3.MatInput, selector: "input[matInput], textarea[matInput], select[matNativeControl],      input[matNativeControl], textarea[matNativeControl]", inputs: ["disabled", "id", "placeholder", "name", "required", "type", "errorStateMatcher", "aria-describedby", "value", "readonly"], exportAs: ["matInput"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.2.2", ngImport: i0, type: FormInputComponent, decorators: [{
            type: Component,
            args: [{ selector: "dom-form-input", standalone: true, imports: [
                        CommonModule,
                        ReactiveFormsModule,
                        MatFormFieldModule,
                        MatInputModule,
                    ], changeDetection: ChangeDetectionStrategy.OnPush, template: "<mat-form-field class=\"full-width\">\n  <mat-label>{{ label() }}</mat-label>\n  <input\n    #input\n    matInput\n    [type]=\"type() || 'text'\"\n    [formControl]=\"formControl()\"\n    autocomplete=\"off\"\n    [name]=\"key()\"\n  />\n\n  @if (hint()) {\n\n  <!-- <mat-hint> {{ \"Please enter your \" + hint() }}</mat-hint> -->\n  <mat-hint> {{ formControl().errors }}</mat-hint>\n  } @if (hasError()) {\n  <mat-error>{{ errorMessage() }}</mat-error>\n  }\n</mat-form-field>\n", styles: ["mat-form-field{width:100%;display:inline-block}input[type=number]::-webkit-inner-spin-button{-webkit-appearance:none}\n"] }]
        }] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybS1pbnB1dC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9saWJzL3NyYy9saWIvZG9tL2NvbXBvbmVudHMvZm9ybS1pbnB1dC9mb3JtLWlucHV0LmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uL2xpYnMvc3JjL2xpYi9kb20vY29tcG9uZW50cy9mb3JtLWlucHV0L2Zvcm0taW5wdXQuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQy9DLE9BQU8sRUFDTCx1QkFBdUIsRUFDdkIsU0FBUyxFQUNULFFBQVEsRUFHUixRQUFRLEVBQ1IsTUFBTSxFQUNOLEtBQUssRUFDTCxxQkFBcUIsR0FDdEIsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ3RELE9BQU8sRUFHTCxtQkFBbUIsR0FFcEIsTUFBTSxnQkFBZ0IsQ0FBQztBQUN4QixPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQztBQUNsRSxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDekQsT0FBTyxFQUFjLEdBQUcsRUFBRSxTQUFTLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDbEQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLGVBQWUsQ0FBQzs7Ozs7QUFlaEQsTUFBTSxPQUFPLGtCQUFrQjtJQWIvQjtRQWNtQixjQUFTLEdBQWEsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBRXhELFlBQU8sR0FBRyxLQUFLLENBQUMsUUFBUSxFQUE0QyxDQUFDO1FBQ3JFLFFBQUcsR0FBRyxLQUFLLENBQUMsUUFBUSxFQUFVLENBQUM7UUFDL0IsU0FBSSxHQUFHLEtBQUssRUFBVSxDQUFDO1FBQ3ZCLFVBQUssR0FBRyxLQUFLLEVB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dXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbW1vbk1vZHVsZSB9IGZyb20gXCJAYW5ndWxhci9jb21tb25cIjtcbmltcG9ydCB7XG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICBDb21wb25lbnQsXG4gIEluamVjdG9yLFxuICBPbkluaXQsXG4gIFNpZ25hbCxcbiAgY29tcHV0ZWQsXG4gIGluamVjdCxcbiAgaW5wdXQsXG4gIHJ1bkluSW5qZWN0aW9uQ29udGV4dCxcbn0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcbmltcG9ydCB7IHRvU2lnbmFsIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmUvcnhqcy1pbnRlcm9wXCI7XG5pbXBvcnQge1xuICBBYnN0cmFjdENvbnRyb2wsXG4gIEZvcm1Db250cm9sLFxuICBSZWFjdGl2ZUZvcm1zTW9kdWxlLFxuICBWYWxpZGF0aW9uRXJyb3JzLFxufSBmcm9tIFwiQGFuZ3VsYXIvZm9ybXNcIjtcbmltcG9ydCB7IE1hdEZvcm1GaWVsZE1vZHVsZSB9IGZyb20gXCJAYW5ndWxhci9tYXRlcmlhbC9mb3JtLWZpZWxkXCI7XG5pbXBvcnQgeyBNYXRJbnB1dE1vZHVsZSB9IGZyb20gXCJAYW5ndWxhci9tYXRlcmlhbC9pbnB1dFwiO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgbWFwLCBzdGFydFdpdGggfSBmcm9tIFwicnhqc1wiO1xuaW1wb3J0IHsgZXJyb3JNZXNzYWdlTWFwIH0gZnJvbSBcIi4vZm9ybS5oZWxwZXJcIjtcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiBcImRvbS1mb3JtLWlucHV0XCIsXG4gIHN0YW5kYWxvbmU6IHRydWUsXG4gIGltcG9ydHM6IFtcbiAgICBDb21tb25Nb2R1bGUsXG4gICAgUmVhY3RpdmVGb3Jtc01vZHVsZSxcbiAgICBNYXRGb3JtRmllbGRNb2R1bGUsXG4gICAgTWF0SW5wdXRNb2R1bGUsXG4gIF0sXG4gIHRlbXBsYXRlVXJsOiBcIi4vZm9ybS1pbnB1dC5jb21wb25lbnQuaHRtbFwiLFxuICBzdHlsZVVybHM6IFtcIi4vZm9ybS1pbnB1dC5jb21wb25lbnQuc2Nzc1wiXSxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG59KVxuZXhwb3J0IGNsYXNzIEZvcm1JbnB1dENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gIHByaXZhdGUgcmVhZG9ubHkgX2luamVjdG9yOiBJbmplY3RvciA9IGluamVjdChJbmplY3Rvcik7XG5cbiAgY29udHJvbCA9IGlucHV0LnJlcXVpcmVkPEFic3RyYWN0Q29udHJvbDx1bmtub3duLCB1bmtub3duPiB8IG51bGw+KCk7XG4gIGtleSA9IGlucHV0LnJlcXVpcmVkPHN0cmluZz4oKTtcbiAgdHlwZSA9IGlucHV0PHN0cmluZz4oKTtcbiAgbGFiZWwgPSBpbnB1dDxzdHJpbmc+KCk7XG4gIGhpbnQgPSBpbnB1dDxzdHJpbmc+KCk7XG4gIGVycm9yc01hcCA9IGlucHV0PFZhbGlkYXRpb25FcnJvcnM+KCk7XG5cbiAgZm9ybUNvbnRyb2whOiBTaWduYWw8Rm9ybUNvbnRyb2w+O1xuICBlcnJvck1lc3NhZ2UhOiBTaWduYWw8c3RyaW5nIHwgdW5kZWZpbmVkPjtcbiAgaGFzRXJyb3IhOiBTaWduYWw8Ym9vbGVhbj47XG5cbiAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgdGhpcy5mb3JtQ29udHJvbCA9IGNvbXB1dGVkKCgpID0+IHRoaXMuY29udHJvbCgpIGFzIEZvcm1Db250cm9sKTtcbiAgICB0aGlzLmhhc0Vycm9yID0gdGhpcy5fc2V0SGFzRXJyb3JTaWduYWwodGhpcy5mb3JtQ29udHJvbCgpKTtcbiAgICB0aGlzLmVycm9yTWVzc2FnZSA9IHRoaXMuX3NldEVycm9yTWVzc2FnZVNpZ25hbCh0aGlzLmZvcm1Db250cm9sKCkpO1xuICB9XG5cbiAgcHJpdmF0ZSBfc2V0RXJyb3JNZXNzYWdlU2lnbmFsKGZvcm1Db250cm9sOiBGb3JtQ29udHJvbCk6IFNpZ25hbDxzdHJpbmc+IHtcbiAgICByZXR1cm4gcnVuSW5JbmplY3Rpb25Db250ZXh0KHRoaXMuX2luamVjdG9yLCAoKSA9PlxuICAgICAgdG9TaWduYWwodGhpcy5fc2V0RXJyb3JPYnNlcnZhYmxlKGZvcm1Db250cm9sKSwge1xuICAgICAgICBpbml0aWFsVmFsdWU6IHRoaXMuX2dldEVycm9yTWVzc2FnZShmb3JtQ29udHJvbCksXG4gICAgICB9KVxuICAgICk7XG4gIH1cblxuICBwcml2YXRlIF9zZXRFcnJvck9ic2VydmFibGUoZm9ybUNvbnRyb2w6IEZvcm1Db250cm9sKTogT2JzZXJ2YWJsZTxzdHJpbmc+IHtcbiAgICByZXR1cm4gZm9ybUNvbnRyb2wuc3RhdHVzQ2hhbmdlcy5waXBlKFxuICAgICAgbWFwKCgpID0+IHRoaXMuX2dldEVycm9yTWVzc2FnZShmb3JtQ29udHJvbCkpXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgX3NldEhhc0Vycm9yU2lnbmFsKGZvcm1Db250cm9sOiBGb3JtQ29udHJvbCk6IFNpZ25hbDxib29sZWFuPiB7XG4gICAgcmV0dXJuIHJ1bkluSW5qZWN0aW9uQ29udGV4dCh0aGlzLl9pbmplY3RvciwgKCkgPT5cbiAgICAgIHRvU2lnbmFsKHRoaXMuX3NldEhhc0Vycm9yT2JzZXJ2YWJsZShmb3JtQ29udHJvbCksIHtcbiAgICAgICAgaW5pdGlhbFZhbHVlOiBmYWxzZSxcbiAgICAgIH0pXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgX3NldEhhc0Vycm9yT2JzZXJ2YWJsZShcbiAgICBmb3JtQ29udHJvbDogRm9ybUNvbnRyb2xcbiAgKTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XG4gICAgcmV0dXJuIGZvcm1Db250cm9sLnN0YXR1c0NoYW5nZXMucGlwZShcbiAgICAgIHN0YXJ0V2l0aChmb3JtQ29udHJvbC5zdGF0dXMpLFxuICAgICAgbWFwKCgpID0+IGZvcm1Db250cm9sLmVycm9ycyksXG4gICAgICBtYXAoKGVycm9yczogVmFsaWRhdGlvbkVycm9ycyB8IG51bGwpID0+ICEhZXJyb3JzKVxuICAgICk7XG4gIH1cblxuICAvLyBoYW5kbGUgaW5wdXQgZXJyb3IgbWVzc2FnZXNcbiAgcHJpdmF0ZSBfZ2V0RXJyb3JNZXNzYWdlKGNvbnRyb2w6IEZvcm1Db250cm9sIHwgQWJzdHJhY3RDb250cm9sKTogc3RyaW5nIHtcbiAgICBjb25zdCBlcnJvcnMgPSB7IC4uLmNvbnRyb2wuZXJyb3JzIH07XG5cbiAgICBpZiAoZXJyb3JzKSB7XG4gICAgICBjb25zdCBlcnJvcktleXM6IHN0cmluZ1tdID0gT2JqZWN0LmtleXMoZXJyb3JzIGFzIG9iamVjdCk7XG5cbiAgICAgIGZvciAoY29uc3QgZXJyb3Igb2YgZXJyb3JLZXlzKSB7XG4gICAgICAgIGlmIChjb250cm9sLmhhc0Vycm9yKGVycm9yKSkge1xuICAgICAgICAgIGNvbnN0IGVycm9yTWFwID0ge1xuICAgICAgICAgICAgLi4uZXJyb3JzLFxuICAgICAgICAgICAgLi4uZXJyb3JNZXNzYWdlTWFwLFxuICAgICAgICAgICAgLi4udGhpcy5lcnJvcnNNYXAoKSxcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgcmV0dXJuIGVycm9yTWFwW2Vycm9yXSBhcyBzdHJpbmc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gXCJcIjtcbiAgfVxufVxuIiwiPG1hdC1mb3JtLWZpZWxkIGNsYXNzPVwiZnVsbC13aWR0aFwiPlxuICA8bWF0LWxhYmVsPnt7IGxhYmVsKCkgfX08L21hdC1sYWJlbD5cbiAgPGlucHV0XG4gICAgI2lucHV0XG4gICAgbWF0SW5wdXRcbiAgICBbdHlwZV09XCJ0eXBlKCkgfHwgJ3RleHQnXCJcbiAgICBbZm9ybUNvbnRyb2xdPVwiZm9ybUNvbnRyb2woKVwiXG4gICAgYXV0b2NvbXBsZXRlPVwib2ZmXCJcbiAgICBbbmFtZV09XCJrZXkoKVwiXG4gIC8+XG5cbiAgQGlmIChoaW50KCkpIHtcblxuICA8IS0tIDxtYXQtaGludD4ge3sgXCJQbGVhc2UgZW50ZXIgeW91ciBcIiArIGhpbnQoKSB9fTwvbWF0LWhpbnQ+IC0tPlxuICA8bWF0LWhpbnQ+IHt7IGZvcm1Db250cm9sKCkuZXJyb3JzIH19PC9tYXQtaGludD5cbiAgfSBAaWYgKGhhc0Vycm9yKCkpIHtcbiAgPG1hdC1lcnJvcj57eyBlcnJvck1lc3NhZ2UoKSB9fTwvbWF0LWVycm9yPlxuICB9XG48L21hdC1mb3JtLWZpZWxkPlxuIl19