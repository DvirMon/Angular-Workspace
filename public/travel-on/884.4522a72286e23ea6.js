"use strict";(self.webpackChunktravel_on=self.webpackChunktravel_on||[]).push([[884],{5884:(Ot,S,i)=>{i.r(S),i.d(S,{PlacesComponent:()=>St});var y=i(1528),t=i(4496),h=i(1368),m=i(7816),C=i(1560),I=i(2100);let w=(()=>{class n{constructor(){this.side=(0,t.YhN)("right"),this.label=(0,t.YhN)(),this.routerLink=(0,t.YhN)(),this.clicked=new t._w7}static#e=this.\u0275fac=function(a){return new(a||n)};static#t=this.\u0275cmp=t.In1({type:n,selectors:[["dom-floating-button"]],inputs:{side:[t.Wk5.SignalBased,"side"],label:[t.Wk5.SignalBased,"label"],routerLink:[t.Wk5.SignalBased,"routerLink"]},outputs:{clicked:"clicked"},standalone:!0,features:[t.UHJ],decls:3,vars:17,consts:[["mat-raised-button","","color","accent",3,"disableRipple","routerLink","click"]],template:function(a,o){1&a&&(t.I0R(0,"button",0),t.qCj("click",function(){return o.clicked.emit()}),t.OEk(1),t.wVc(2,"titlecase"),t.C$Y()),2&a&&(t.m4B("right","left"===o.side()?null:0,"px")("left","right"===o.side()?null:0,"px")("border-top-right-radius","left"===o.side()?25:null,"px")("border-bottom-right-radius","left"===o.side()?25:null,"px")("border-top-left-radius","right"===o.side()?25:null,"px")("border-bottom-left-radius","right"===o.side()?25:null,"px"),t.E7m("disableRipple",!0)("routerLink",o.routerLink()),t.yG2(),t.oRS(" ",t.kDX(2,15,o.label())," "))},dependencies:[h.MD,h.oL,I.qQ,I.ER,m.oJ,m.Gw,C.oB],styles:["button[_ngcontent-%COMP%]{position:fixed;top:64px}"],changeDetection:0})}return n})();var D=i(5196),f=i(2080),u=i(9684),Y=i(4872),$=i(6700),x=i(3412),O=i(2644),g=i(4704),G=i(112),U=i(7228),T=i(3992),B=i(5448),N=i(7773),A=i(308),j=i(320),V=i(7400),W=i(560);function M(n,s){return s?e=>(0,U.W)(s.pipe((0,T.U)(1),function b(){return(0,B.i)((n,s)=>{n.subscribe((0,N.e)(s,A.K))})}()),e.pipe(M(n))):(0,V.O)((e,a)=>(0,W.Uv)(n(e,a)).pipe((0,T.U)(1),(0,j.e)(e)))}var K=i(4548),r=function(n){return n.DEFAULT="default",n.CHANGED="changeState",n.SELECTED="selected",n}(r||{});let J=(()=>{class n{constructor(){this.selected=t.YhN.required(),this.changed=new t._w7,this.isSelected=(0,t.S6b)(()=>this.selected()?r.SELECTED:r.DEFAULT),this.clickEvent=new $.g(r.DEFAULT),this.iconState=(0,Y.i6)(this._getIconState$())}_getIconState$(){return(0,x.U)(this._getChangeState$(),this._getSelectedState$())}_getChangeState$(){return this.clickEvent.asObservable().pipe((0,O.s)(1),(0,g.k)(()=>r.CHANGED))}_getSelectedState$(){return this.clickEvent.asObservable().pipe((0,O.s)(1),function H(n,s=G.M){const e=(0,K.k)(n,s);return M(()=>e)}(300),(0,g.k)(e=>e===r.SELECTED),(0,g.k)(e=>e?r.DEFAULT:r.SELECTED))}onButtonClick(e){if(void 0===e&&(e=this.isSelected()),e===r.CHANGED)return;this.clickEvent.next(e);const a=this._calculateNewState(e);this._handleChangeEvent(a)}_calculateNewState(e){return e===r.DEFAULT?r.SELECTED:r.DEFAULT}_handleChangeEvent(e){const a=this._createChangeEvent(e);this._emitChangeEvent(a)}_emitChangeEvent(e){this.changed.emit(e)}_createChangeEvent(e){return{source:this,selected:e!==r.DEFAULT}}static#e=this.\u0275fac=function(a){return new(a||n)};static#t=this.\u0275cmp=t.In1({type:n,selectors:[["to-place-card-button"]],inputs:{selected:[t.Wk5.SignalBased,"selected"]},outputs:{changed:"changed"},standalone:!0,features:[t.UHJ],decls:2,vars:1,consts:[["mat-icon-button","","color","warn",3,"click"],["fontIcon","favorite"]],template:function(a,o){1&a&&(t.I0R(0,"button",0),t.qCj("click",function(){return o.onButtonClick(o.iconState())}),t.wR5(1,"mat-icon",1),t.C$Y()),2&a&&(t.yG2(),t.E7m("@iconAnimation",void 0===o.iconState()?o.isSelected():o.iconState()))},dependencies:[h.MD,m.oJ,m.um,C.oB,C.qL],data:{animation:[(0,u.gV)("iconAnimation",[(0,u.K2)("default",(0,u.wb)({transform:"scale(1)",color:"#9E9E9E"})),(0,u.K2)("changeState",(0,u.wb)({transform:"scale(1.2)"})),(0,u.K2)("selected",(0,u.wb)({transform:"scale(1)"})),(0,u.aK)("default <=> changeState",(0,u.Cs)("0.1s ease")),(0,u.aK)("selected <=> changeState",(0,u.Cs)("0.1s ease"))])]},changeDetection:0})}return n})();var P=i(4688);let Q=(()=>{class n{transform(e,a="medium"){const o=this.convertToDate(e);return(0,h._m)(o,a,"en-US")}convertToDate(e){return e instanceof P.kR?e.toDate():e}static#e=this.\u0275fac=function(a){return new(a||n)};static#t=this.\u0275pipe=t.UTH({name:"dateTimestampPipe",type:n,pure:!0,standalone:!0})}return n})();function z(n,s){if(1&n){const e=t.KQA();t.I0R(0,"mat-card"),t.wR5(1,"img",0),t.I0R(2,"mat-card-header")(3,"mat-card-title"),t.OEk(4),t.C$Y(),t.I0R(5,"mat-card-subtitle"),t.OEk(6),t.wVc(7,"currency"),t.C$Y(),t.I0R(8,"to-place-card-button",1),t.qCj("changed",function(o){t.usT(e);const c=t.GaO();return t.CGJ(c.onSelectedChanged(o))}),t.C$Y()(),t.I0R(9,"mat-card-content")(10,"section",2)(11,"span")(12,"b"),t.OEk(13,"Takeoff:"),t.C$Y(),t.OEk(14),t.wVc(15,"dateTimestampPipe"),t.C$Y(),t.I0R(16,"span")(17,"b"),t.OEk(18,"Landing:"),t.C$Y(),t.OEk(19),t.wVc(20,"dateTimestampPipe"),t.C$Y()()(),t.wR5(21,"mat-card-footer"),t.C$Y()}if(2&n){const e=t.GaO();t.yG2(),t.E7m("ngSrc",e.place().imageUrl),t.yG2(3),t.CAO("",e.place().destination.city,", ",e.place().destination.country,""),t.yG2(2),t.cNF(t.wB1(7,7,e.place().price,"USD","symbol","1.0-0")),t.yG2(2),t.E7m("selected",e.selected()),t.yG2(6),t.oRS(" ",t.g7$(15,12,e.place().takeoff,"EEEE, MMMM d, h:mm a")," "),t.yG2(5),t.oRS(" ",t.g7$(20,15,e.place().landing,"EEEE, MMMM d, h:mm a")," ")}}let Z=(()=>{class n{constructor(){this.place=t.YhN.required(),this.selected=t.YhN.required(),this.showOverlay=(0,t.OCB)(!1),this.selectedChanged=new t._w7}_createChangedEvent(e){return{selected:e.selected,source:this}}onSelectedChanged(e){const a=this._createChangedEvent(e);this.selectedChanged.emit(a)}onToggleOverlay(){this.showOverlay.update(e=>!e)}static#e=this.\u0275fac=function(a){return new(a||n)};static#t=this.\u0275cmp=t.In1({type:n,selectors:[["to-places-card"]],inputs:{place:[t.Wk5.SignalBased,"place"],selected:[t.Wk5.SignalBased,"selected"]},outputs:{selectedChanged:"selectedChanged"},standalone:!0,features:[t.UHJ],decls:1,vars:1,consts:[["mat-card-image","","height","750","width","1125","priority","","alt","alternative",3,"ngSrc"],[3,"selected","changed"],[1,"schedule"]],template:function(a,o){1&a&&t.yuY(0,z,22,18,"mat-card"),2&a&&t.C0Y(0,o.place()?0:-1)},dependencies:[h.MD,h.cf,h.ys,Q,f.NR,f.SM,f.WK,f.Yr,f.Uc,f.MN,f.uK,f.gp,J],styles:["mat-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:300px;width:100%}mat-card[_ngcontent-%COMP%]   .mat-mdc-card-header[_ngcontent-%COMP%]{justify-content:space-between;align-items:flex-end}mat-card[_ngcontent-%COMP%]   .mat-mdc-card-content[_ngcontent-%COMP%]{padding:16px}mat-card[_ngcontent-%COMP%]   section.schedule[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}div.image-overlay-container[_ngcontent-%COMP%]{position:relative}div.overlay[_ngcontent-%COMP%]{height:100%;position:absolute;inset:0;background:#3f51b599;color:#fff;font-weight:550;display:flex;flex-direction:column;align-items:center;justify-content:center;opacity:0}"],changeDetection:0})}return n})();function X(n,s){if(1&n){const e=t.KQA();t.SAx(0),t.I0R(1,"section",2)(2,"to-places-card",3),t.qCj("selectedChanged",function(o){t.usT(e);const c=t.GaO();return t.CGJ(c.onSelectedChanged(o))}),t.C$Y()(),t.k70()}if(2&n){const e=s.$implicit,a=t.GaO();t.yG2(2),t.E7m("place",e)("selected",a.selection()[e.id])}}let q=(()=>{class n{constructor(){this.places=t.YhN.required(),this.selection=t.YhN.required(),this.selectionChanged=new t._w7}onSelectedChanged(e){const{source:a,selected:o}=e,{place:c}=a;this._emitChangeEvent({placeId:c().id,selected:o})}_emitChangeEvent(e){this.selectionChanged.emit({source:this,currentSelection:e})}static#e=this.\u0275fac=function(a){return new(a||n)};static#t=this.\u0275cmp=t.In1({type:n,selectors:[["to-places-list"]],inputs:{places:[t.Wk5.SignalBased,"places"],selection:[t.Wk5.SignalBased,"selection"]},outputs:{selectionChanged:"selectionChanged"},standalone:!0,features:[t.UHJ],decls:2,vars:1,consts:[[1,"places-list-wrapper"],[4,"ngFor","ngForOf"],[1,"places-card-wrapper"],[3,"place","selected","selectedChanged"]],template:function(a,o){1&a&&(t.I0R(0,"div",0),t.yuY(1,X,3,2,"ng-container",1),t.C$Y()),2&a&&(t.yG2(),t.E7m("ngForOf",o.places()))},dependencies:[h.MD,h.ay,Z],styles:["div.places-list-wrapper[_ngcontent-%COMP%]{width:100%;overflow-wrap:hidden;padding:16px;display:flex;flex-wrap:wrap;gap:24px}div.places-list-wrapper[_ngcontent-%COMP%]   section.places-card-wrapper[_ngcontent-%COMP%]{width:30%}"]})}return n})();var _=i(7836),l=i(4032),d=i(1276),E=i(9900);let tt=(()=>{class n{constructor(e){this.firestore=e,this.VACATIONS_COLLECTION="vacations",this.vacationsRef=(0,d.oV)(this.firestore,this.VACATIONS_COLLECTION)}loadPlaces(){const e=(0,d.kt)(this.vacationsRef);return(0,E.Q)((0,d.uY)(e)).pipe((0,g.k)(a=>a.docs.map(o=>({...o.data(),id:o.id}))),(0,g.k)(a=>({content:a})))}static#e=this.\u0275fac=function(a){return new(a||n)(t.CoB(d.OI))};static#t=this.\u0275prov=t.wxM({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var et=i(196),nt=i(952),at=i(3928),v=i(7368),ot=i(8960);function L(n,s){return(0,t.SMS)((0,t.uUt)(t.zZn),()=>{const e=(0,t.uUt)(n);return a=>e[s](a)})}function R(n,s,e){return(0,nt.k)((0,at.W)((0,v.G)(a=>n(a).pipe((0,et.E)({next:o=>(0,l.yo)(s,{[e]:o.content}),error:()=>ot.k})))))}const ct={places:[]};var dt=i(2700),ut=i(1424),ht=i(2908);let F=(()=>{class n{constructor(e){this.firestore=e,this.FAVORITES_COLLECTION="favorites",this.favoritesRef=(0,d.oV)(this.firestore,this.FAVORITES_COLLECTION)}_createNewFavoriteDoc$(e,a){const o=function ft(n){return{userId:n,vacationIds:[],createdAt:P.kR.fromDate(new Date)}}(a);return(0,E.Q)((0,d.sB)(e,o)).pipe((0,v.G)(c=>(0,dt.of)({...o,id:c.id})))}loadFavorites(e){const a=(0,E.Q)((0,d.uY)((0,d.kt)(this.favoritesRef,(0,d.A9)("userId","==",e)))),o=a.pipe((0,v.G)(()=>this._createNewFavoriteDoc$(this.favoritesRef,e))),c=a.pipe((0,ht.Iv)());return a.pipe((0,v.G)(p=>function pt(n,s,e){return(0,ut.Q)(()=>n()?s:e)}(()=>p.empty,o,c)),(0,g.k)(p=>({content:[p]})))}updateFavoriteDoc(e,a){const o=(0,d.UN)(this.favoritesRef,e);return(0,d.Sm)(o,a)}static#e=this.\u0275fac=function(a){return new(a||n)(t.CoB(d.OI))};static#t=this.\u0275prov=t.wxM({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Et=(0,l.El)({providedIn:"root"},(0,_.Wq)("store"),function lt(n){return(0,l.q)((0,l.eq)(ct),(0,l.k7)(s=>({loadPlaces:R(L(n,"loadPlaces"),s,"places")})))}(tt),function mt(n){return(0,l.q)((0,l.eq)({favorite:[]}),(0,l.k7)(s=>({loadFavorites:R(L(n,"loadFavorites"),s,"favorite")})),(0,l.k7)((s,e=(0,t.uUt)(F))=>({updateFavorite:a=>(0,y.c)(function*(){const o=s.favorite()[0],{vacationIds:c,id:p}=o,k=function Ct(n,s){const{placeId:e,selected:a}=n;return a?[...s,e]:s.filter(o=>o!==e)}(a,c),yt={...o,vacationIds:k};yield e.updateFavoriteDoc(p,yt),(0,l.yo)(s,It=>({favorite:{...It.favorite,vacationIds:k}}))})()})),(0,l.G)(({favorite:s})=>({favoriteMap:(0,t.S6b)(()=>function vt(n){return n?n.vacationIds.reduce((s,e)=>({...s,[e]:!0}),{}):{}}(s()[0]))})))}(F),(0,l.oL)(n=>({onInit(){n.loadPlaces()}})));let St=(()=>{class n{#e;#t;constructor(){this.#e=(0,t.uUt)(t.zZn),this.#t=(0,t.uUt)(Et),this.userId=t.YhN.required(),this.places=this.#t.places,this.selection=this.#t.favoriteMap}ngOnInit(){this.#t.loadFavorites(this.userId)}onSelectionChanged(e){var a=this;return(0,y.c)(function*(){const{currentSelection:o}=e;yield a.#t.updateFavorite(o)})()}onLogout(){(0,t.SMS)(this.#e,()=>(0,t.uUt)(D.$).logout())}static#n=this.\u0275fac=function(a){return new(a||n)};static#a=this.\u0275cmp=t.In1({type:n,selectors:[["to-places"]],inputs:{userId:[t.Wk5.SignalBased,"userId"]},standalone:!0,features:[t.UHJ],decls:8,vars:3,consts:[[1,"places-wrapper"],[1,"parallax-image"],[1,"spacer"],[3,"label","clicked"],[1,"places-list-container"],[1,"content"],[3,"places","selection","selectionChanged"]],template:function(a,o){1&a&&(t.I0R(0,"div",0),t.wR5(1,"div",1),t.I0R(2,"header"),t.wR5(3,"div",2),t.I0R(4,"dom-floating-button",3),t.qCj("clicked",function(){return o.onLogout()}),t.C$Y()(),t.I0R(5,"div",4)(6,"main",5)(7,"to-places-list",6),t.qCj("selectionChanged",function(p){return o.onSelectionChanged(p)}),t.C$Y()()()()),2&a&&(t.yG2(4),t.E7m("label","Logout"),t.yG2(3),t.E7m("places",o.places())("selection",o.selection()))},dependencies:[q,w],styles:["div.places-wrapper[_ngcontent-%COMP%]{position:relative;overflow:hidden;height:100vh}.parallax-image[_ngcontent-%COMP%]{background-image:url(user.9ff56192b726b238.jpg);position:absolute;top:0;left:0;width:100%;height:100%;background-size:cover;background-position:center}div.spacer[_ngcontent-%COMP%]{height:150px}div.places-list-container[_ngcontent-%COMP%]{height:100%;justify-content:center;display:flex;width:100%}main.content[_ngcontent-%COMP%]{top:0;left:0;width:90%;height:80%;overflow-y:scroll}"],changeDetection:0})}return n})()}}]);